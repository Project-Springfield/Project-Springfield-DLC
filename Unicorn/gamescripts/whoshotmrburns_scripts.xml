<ScriptPackage>
	<ShowMiniEventIntro>
		<Action type="miniEventPanel">
			<Attribute name="config">
				<AttributeSet name="source">
					<Attribute name="file" value="WhoShotMrBurnsMiniEventPopUp" />
				</AttributeSet>
				<AttributeSet name="playButtonText">
					<Requirement type="variable" variable="WhoShotMrBurns_IntroSeen" not="true" />
					<Attribute name="text" value="UI_MiniEvents_PlayButton" localise="true" />
				</AttributeSet>
				<AttributeSet name="playButtonTextHL">
					<Requirement type="variable" variable="WhoShotMrBurns_IntroSeen" not="true" />
					<Attribute name="text" value="UI_MiniEvents_PlayButton" localise="true" />
				</AttributeSet>
				<AttributeSet name="playButtonText">
					<Requirement type="variable" variable="WhoShotMrBurns_IntroSeen" />
					<Attribute name="text" value="UI_OK" localise="true" />
				</AttributeSet>
				<AttributeSet name="playButtonTextHL">
					<Requirement type="variable" variable="WhoShotMrBurns_IntroSeen" />
					<Attribute name="text" value="UI_OK" localise="true" />
				</AttributeSet>
				<AttributeSet name="titleText">
					<Attribute name="text" value="UI_WhoShotMrBurns_Title" localise="true" />
					<Attribute name="color" value="ffcb1bff" />
				</AttributeSet>
				<AttributeSet name="timeLeft">
					<Attribute name="text" value="UI_WhoShotMrBurns_IntroPanel_Timer" localise="true" />
					<Attribute name="color" value="FFFFFFFF" />
				</AttributeSet>
				<AttributeSet name="textColumn1">
					<Attribute name="text" value="UI_WhoShotMrBurns_IntroPanel_3" localise="true" />
					<Attribute name="color" value="000000FF" />
				</AttributeSet>
				<AttributeSet name="textColumn2">
					<Attribute name="text" value="UI_WhoShotMrBurns_IntroPanel_1" localise="true" />
					<Attribute name="color" value="000000FF" />
				</AttributeSet>
				<AttributeSet name="textColumn3">
					<Attribute name="text" value="UI_WhoShotMrBurns_IntroPanel_2" localise="true" />
					<Attribute name="color" value="000000FF" />
				</AttributeSet>
				<AttributeSet name="panel">
					<Attribute name="image" value="BSE_WhoShotMrBurns_MiniEventPanel_Intro" />
				</AttributeSet>
				<AttributeSet name="playButton">
					<Attribute name="color" value="0091F1FF" />
				</AttributeSet>
			</Attribute>
		</Action>
		<Action type="setVariable" boolVariable="WhoShotMrBurns_IntroSeen" boolValue="true" />
		<Action type="updateVariable" variable="WhoShotMrBurns_Store" value="true" />
		<Action type="recommendation" recType="Event" name="WhoShotMrBurns_OnePanel" eventName="UI_WhoShotMrBurns_Title" limitedTime="true" limitedTimeEndDate="WhoShotMrBurns_End" />
		<Action type="reparseBuildMenu" />
	</ShowMiniEventIntro>
	<ShowMiniEventOutro>
		<Action type="miniEventPanel">
			<Attribute name="config">
				<AttributeSet name="source">
					<Attribute name="file" value="WhoShotMrBurnsMiniEventPopUp" />
				</AttributeSet>
				<AttributeSet name="playButtonText">
					<Attribute name="text" value="UI_OK" localise="true" />
				</AttributeSet>
				<AttributeSet name="playButtonTextHL">
					<Attribute name="text" value="UI_OK" localise="true" />
				</AttributeSet>
				<AttributeSet name="titleText">
					<Attribute name="text" value="UI_WhoShotMrBurns_Title" localise="true" />
					<Attribute name="color" value="ffcb1bff" />
				</AttributeSet>
				<AttributeSet name="textColumn4">
					<Attribute name="text" value="UI_WhoShotMrBurns_OutroPanel_1" localise="true" />
					<Attribute name="color" value="000000FF" />
				</AttributeSet>
				<AttributeSet name="textColumn5">
					<Attribute name="text" value="UI_WhoShotMrBurns_OutroPanel_2" localise="true" />
					<Attribute name="color" value="000000FF" />
				</AttributeSet>
				<AttributeSet name="panel">
					<Attribute name="image" value="BSE_WhoShotMrBurns_MiniEventPanel_Outro" />
				</AttributeSet>
				<AttributeSet name="playButton">
					<Attribute name="color" value="0091F1FF" />
				</AttributeSet>
			</Attribute>
		</Action>
		<Action type="setVariable" boolVariable="WhoShotMrBurns_Complete" boolValue="true" />
	</ShowMiniEventOutro>
	<OpenMasterQuest>
		<Action type="checkRequirements">
			<Requirement type="land" land="Springfield" />
			<True>
				<Action type="gotoState" state="GameState_QuestProgress">
					<Extras>
						<Attribute name="questParentDelegate" value="WhoShotMrBurns_MasterQuest" />
					</Extras>
				</Action>
			</True>
			<False>
				<Action type="pantoobject" building="KrustylandShuttleToSpringfield" fakeTouch="true" />
			</False>
		</Action>
	</OpenMasterQuest>
	<ShowJobList ignoreHUD="true">
		<Action type="checkRequirements">
			<Requirement type="land" land="Springfield" />
			<True>
				<Action type="if">
					<If>
						<Requirement type="active quest" quest="WhoShotMrBurnsPartThree_1" />
						<Then>
							<Action type="gotoState" state="GameState_SpecialEventJobList">
								<Extras>
									<Attribute name="SpecialEvent" value="WhoShotMrBurns_Event" />
									<Attribute name="JobList" value="WhoShotMrBurns_JL_1" />
								</Extras>
							</Action>
						</Then>
					</If>
					<ElseIf>
						<Requirement type="active quest" quest="WhoShotMrBurnsPartThree_2" />
						<Then>
							<Action type="gotoState" state="GameState_SpecialEventJobList">
								<Extras>
									<Attribute name="SpecialEvent" value="WhoShotMrBurns_Event" />
									<Attribute name="JobList" value="WhoShotMrBurns_JL_2" />
								</Extras>
							</Action>
						</Then>
					</ElseIf>
					<ElseIf>
						<Requirement type="active quest" quest="WhoShotMrBurnsPartThree_3" />
						<Then>
							<Action type="gotoState" state="GameState_SpecialEventJobList">
								<Extras>
									<Attribute name="SpecialEvent" value="WhoShotMrBurns_Event" />
									<Attribute name="JobList" value="WhoShotMrBurns_JL_3" />
								</Extras>
							</Action>
						</Then>
					</ElseIf>
					<ElseIf>
						<Requirement type="active quest" quest="WhoShotMrBurnsPartThree_4" />
						<Then>
							<Action type="gotoState" state="GameState_SpecialEventJobList">
								<Extras>
									<Attribute name="SpecialEvent" value="WhoShotMrBurns_Event" />
									<Attribute name="JobList" value="WhoShotMrBurns_JL_4" />
								</Extras>
							</Action>
						</Then>
					</ElseIf>
					<ElseIf>
						<Requirement type="active quest" quest="WhoShotMrBurnsPartThree_5" />
						<Then>
							<Action type="gotoState" state="GameState_SpecialEventJobList">
								<Extras>
									<Attribute name="SpecialEvent" value="WhoShotMrBurns_Event" />
									<Attribute name="JobList" value="WhoShotMrBurns_JL_5" />
								</Extras>
							</Action>
						</Then>
					</ElseIf>
					<ElseIf>
						<Requirement type="active quest" quest="WhoShotMrBurnsPartThree_6" />
						<Then>
							<Action type="gotoState" state="GameState_SpecialEventJobList">
								<Extras>
									<Attribute name="SpecialEvent" value="WhoShotMrBurns_Event" />
									<Attribute name="JobList" value="WhoShotMrBurns_JL_6" />
								</Extras>
							</Action>
						</Then>
					</ElseIf>
				</Action>
			</True>
			<False>
				<Action type="pantoobject" building="KrustylandShuttleToSpringfield" fakeTouch="true" />
			</False>
		</Action>
	</ShowJobList>
	<CheckIfEnd ignoreHUD="true">
		<Action type="checkRequirements">
			<Requirement type="variable" variable="WhoShotMrBurns_ExpiryDisplayed" />
			<True>
				<Action type="setVariable" boolVariable="WhoShotMrBurns_Expired" boolValue="true" />
			</True>
		</Action>
		<Action type="actionSequence" script="WhoShotMrBurns_Scripts:ResetRandomCosts" />
	</CheckIfEnd>
	<ExpiryWarning_72hr>
		<Action type="message" text="UI_WhoShotMrBurns_72HourExpiry_text" />
		<Action type="setVariable" boolVariable="WhoShotMrBurns_PreExpiryDisplayed72" boolValue="true" />
		<Action type="runScript" script="WhoShotMrBurns_Scripts:OpenMasterQuest" waitUntilComplete="true" />
	</ExpiryWarning_72hr>
	<ExpiryWarning_24hr>
		<Action type="message" text="{FormattedExpiration24}" formatMe="root">
			<FormattingConfig path="WhoShotMrBurns_GameConfig:ExpirationFormattedText" />
		</Action>
		<Action type="setVariable" boolVariable="WhoShotMrBurns_PreExpiryDisplayed24" boolValue="true" />
		<Action type="runScript" script="WhoShotMrBurns_Scripts:OpenMasterQuest" waitUntilComplete="true" />
	</ExpiryWarning_24hr>
	<DisplayExpiry>
		<Action type="message" text="UI_WhoShotMrBurns_Expired_text" />
		<Action type="clearRecommendations" category="Event" name="WhoShotMrBurns_OnePanel" />
		<Action type="setVariable" boolVariable="WhoShotMrBurns_ExpiryDisplayed" boolValue="true" />
		<Action type="runScript" script="WhoShotMrBurns_Scripts:OpenMasterQuest" waitUntilComplete="true" />
	</DisplayExpiry>
	<MiniEventCompleted>
		<Action type="setVariable" boolVariable="WhoShotMrBurns_Complete" boolValue="true" />
	</MiniEventCompleted>
	<EnterStoreCategory ignoreHUD="true">
		<Action type="focusOnMenuItem" menuCategory="WhoShotMrBurns_Category" />
	</EnterStoreCategory>
	<ResetRandomCosts>
		<Action type="setVariable" intVariable="WSMB_RandomCostJob1" intValue="rand(WSMB_RandomCost)+1" />
		<Action type="setVariable" intVariable="WSMB_RandomCostJob2" intValue="rand(WSMB_RandomCost)+1" />
		<Action type="setVariable" intVariable="WSMB_RandomCostJob3" intValue="rand(WSMB_RandomCost)+1" />
		<Action type="setVariable" intVariable="WSMB_RandomCostJob4" intValue="rand(WSMB_RandomCost)+1" />
		<Action type="setVariable" intVariable="WSMB_RandomCostJob5" intValue="rand(WSMB_RandomCost)+1" />
		<Action type="setVariable" intVariable="WSMB_RandomCostJob6" intValue="rand(WSMB_RandomCost)+1" />
		<Action type="setVariable" intVariable="WSMB_RandomCostJob7" intValue="rand(WSMB_RandomCost)+1" />
		<Action type="setVariable" intVariable="WSMB_RandomCostJob8" intValue="rand(WSMB_RandomCost)+1" />
		<Action type="setVariable" intVariable="WSMB_RandomCostJob_ConvertEverythingToBurnsCoins" intValue="rand(WSMB_RandomCost)+1" />
		<Action type="setVariable" intVariable="WSMB_RandomCostJob_DenyPatientsMRIsToMineBurnsCoins" intValue="rand(WSMB_RandomCost)+1" />
	</ResetRandomCosts>
	<SunblockerTap parallel="true">
		<Action type="actionSequence" script="WhoShotMrBurns_Scripts:SunblockerExtendRetract" />
	</SunblockerTap>
	<SunblockerExtendRetract>
		<Action type="sound" sound="Sunblocker2_tap" />
		<Action type="anim-play" building="SunBlocker2" animation="Active_In" nowait="true" />
		<Action type="fadeScreen" colour="Black" direction="out" speed="0.4" alpha="0.65" />
		<Action type="anim-play" building="SunBlocker2" animation="SunBlocker2_Active" nowait="true" />
		<Action type="delay" time="3.0" />
		<Action type="anim-play" building="SunBlocker2" animation="Active_Out" nowait="true" />
		<Action type="delay" time="0.5" />
		<Action type="fadeScreen" colour="Black" direction="in" speed="0.5" alpha="0.65" />
	</SunblockerExtendRetract>
	<RewardCryptoFarmSkin>
		<Action type="checkRequirements">
			<Requirements>
				<Requirement type="building" building="SpringfieldElementary" />
			</Requirements>
			<True>
				<Action type="notification" title="QST_CryptoFarmRewardStored_WSMB_SystemMessage" text="QST_CryptoFarmFacadeReward_WSMB_SystemMessage" icon="ICO_PRIZ_WhoShotMrBurns_Prize01_MD" button="UI_OK" />
				<Action type="pantoobject" building="SpringfieldElementary" fakeTouch="false" time="0" />
				<Action type="reward">
					<Item type="consumable" name="CryptoFarm" useImmediately="true" />
				</Action>
			</True>
			<False>
				<Action type="reward">
					<Item type="consumable" name="CryptoFarm" useImmediately="true" />
				</Action>
				<Action type="notification" title="QST_CryptoFarmRewardStored_WSMB_SystemMessage" button="UI_OK" text="UI_StoredInInventory_generic" icon="ICO_PRIZ_WhoShotMrBurns_Prize01_MD" />
			</False>
		</Action>
	</RewardCryptoFarmSkin>
</ScriptPackage>