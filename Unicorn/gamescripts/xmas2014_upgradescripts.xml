<ScriptPackage>
	<UpgradeSoundAndAnim>
		<Action type="checkRequirements">
			<Requirement type="building" building="ElfCannon" />
			<True>
				<Action type="anim-building-oneshot" onBuilding="ElfCannon" postdraw="true" nowait="true" requiresInGame="true">
					<OneShot name="regular" file="CannonUpGrade" animation="Castle_upGrade_4x5" x="0" y="0" />
				</Action>
			</True>
		</Action>
	</UpgradeSoundAndAnim>
	<OnElfCannonUpgradedForElvesPerBlast>
		<Action type="runScript" package="XMAS2014_UpgradeScripts" script="UpgradeSoundAndAnim" />
		<Action type="genericMessage">
			<Attribute name="config">
				<AttributeSet name="title">
					<Attribute name="text" value="UI_upgradePanelCastleLvL_title" localise="true" parameters="levelTextData">
						<AttributeSet name="levelTextData">
							<Attribute name="0" formula="Object::ElfCannonLevel+1" />
						</AttributeSet>
					</Attribute>
					<Attribute name="font" value="eFont_LargeBold" />
					<Attribute name="color" value="FFD51AFF" />
				</AttributeSet>
				<AttributeSet name="message">
					<Attribute name="text" value="UI_upgradePanelMessageElvesPerBlast_msg" localise="true" parameters="elvesPerBlastTextData">
						<AttributeSet name="elvesPerBlastTextData">
							<Attribute name="0" formula="System::evaluate('Selector::CanonFireAmount')" />
						</AttributeSet>
					</Attribute>
					<Attribute name="font" value="eFont_Large" />
					<Attribute name="color" value="FFFFFFFF" />
				</AttributeSet>
				<AttributeSet name="button_OK">
					<Attribute name="button_text">
						<AttributeSet name="text">
							<Attribute name="text" value="UI_OK" localise="true" />
						</AttributeSet>
					</Attribute>
				</AttributeSet>
				<AttributeSet name="bg">
					<Attribute name="image" value="ICO_SuperSecretItem" />
				</AttributeSet>
				<AttributeSet name="left">
					<Attribute name="image" value="ICO_XMAS2014_ElfBottleMax_LG" />
				</AttributeSet>
			</Attribute>
		</Action>
		<Action type="setVariable" intVariable="ElfCannonLevel" intValue="ElfCannonLevel+1" />
		<Action type="runScript" package="XMAS2014_UpgradeScripts" script="ConsumeToppedUpGunPowder" />
	</OnElfCannonUpgradedForElvesPerBlast>
	<OnElfCannonUpgradedForElfBerries>
		<Action type="runScript" package="XMAS2014_UpgradeScripts" script="UpgradeSoundAndAnim" />
		<Action type="genericMessage">
			<Attribute name="config">
				<AttributeSet name="title">
					<Attribute name="text" value="UI_upgradePanelCastleLvL_title" localise="true" parameters="levelTextData">
						<AttributeSet name="levelTextData">
							<Attribute name="0" formula="Object::ElfCannonLevel+1" />
						</AttributeSet>
					</Attribute>
					<Attribute name="font" value="eFont_LargeBold" />
					<Attribute name="color" value="FFD51AFF" />
				</AttributeSet>
				<AttributeSet name="message">
					<Attribute name="text" value="UI_upgradePanelMessageElfBerries_msg" localise="true" parameters="elvesPerBlastTextData">
						<AttributeSet name="elvesPerBlastTextData">
							<Attribute name="0" formula="System::evaluate('Selector::CanonBerriesPerLevel')" />
						</AttributeSet>
					</Attribute>
					<Attribute name="font" value="eFont_Large" />
					<Attribute name="color" value="FFFFFFFF" />
				</AttributeSet>
				<AttributeSet name="button_OK">
					<Attribute name="button_text">
						<AttributeSet name="text">
							<Attribute name="text" value="UI_OK" localise="true" />
						</AttributeSet>
					</Attribute>
				</AttributeSet>
				<AttributeSet name="bg">
					<Attribute name="image" value="ICO_SuperSecretItem" />
				</AttributeSet>
				<AttributeSet name="left">
					<Attribute name="image" value="ico_xmas2014_elfbellspayout_lg" />
				</AttributeSet>
			</Attribute>
		</Action>
		<Action type="setVariable" intVariable="ElfCannonLevel" intValue="ElfCannonLevel+1" />
		<Action type="runScript" package="XMAS2014_UpgradeScripts" script="ConsumeToppedUpGunPowder" />
	</OnElfCannonUpgradedForElfBerries>
	<OnElfCannonUpgradedForCooldown>
		<Action type="runScript" package="XMAS2014_UpgradeScripts" script="UpgradeSoundAndAnim" />
		<Action type="genericMessage">
			<Attribute name="config">
				<AttributeSet name="title">
					<Attribute name="text" value="UI_upgradePanelCastleLvL_title" localise="true" parameters="levelTextData">
						<AttributeSet name="levelTextData">
							<Attribute name="0" formula="Object::ElfCannonLevel+1" />
						</AttributeSet>
					</Attribute>
					<Attribute name="font" value="eFont_LargeBold" />
					<Attribute name="color" value="FFD51AFF" />
				</AttributeSet>
				<AttributeSet name="message">
					<Attribute name="text" value="UI_upgradePanelMessageCooldown_msg" localise="true" parameters="elvesPerBlastTextData">
						<AttributeSet name="elvesPerBlastTextData">
							<Attribute name="0" formula="System::evaluate('Selector::CanonHoursToFirePerLevel')" />
						</AttributeSet>
					</Attribute>
					<Attribute name="font" value="eFont_Large" />
					<Attribute name="color" value="FFFFFFFF" />
				</AttributeSet>
				<AttributeSet name="button_OK">
					<Attribute name="button_text">
						<AttributeSet name="text">
							<Attribute name="text" value="UI_OK" localise="true" />
						</AttributeSet>
					</Attribute>
				</AttributeSet>
				<AttributeSet name="bg">
					<Attribute name="image" value="ICO_SuperSecretItem" />
				</AttributeSet>
				<AttributeSet name="left">
					<Attribute name="image" value="ICO_XMAS2014_CooldownReduced_LG" />
				</AttributeSet>
			</Attribute>
		</Action>
		<Action type="setVariable" intVariable="ElfCannonLevel" intValue="ElfCannonLevel+1" />
		<Action type="runScript" package="XMAS2014_UpgradeScripts" script="ConsumeToppedUpGunPowder" />
	</OnElfCannonUpgradedForCooldown>
	<OnElfCannonUpgradedForCooldownMin>
		<Action type="runScript" package="XMAS2014_UpgradeScripts" script="UpgradeSoundAndAnim" />
		<Action type="genericMessage">
			<Attribute name="config">
				<AttributeSet name="title">
					<Attribute name="text" value="UI_upgradePanelCastleLvL_title" localise="true" parameters="levelTextData">
						<AttributeSet name="levelTextData">
							<Attribute name="0" formula="Object::ElfCannonLevel+1" />
						</AttributeSet>
					</Attribute>
					<Attribute name="font" value="eFont_LargeBold" />
					<Attribute name="color" value="FFD51AFF" />
				</AttributeSet>
				<AttributeSet name="message">
					<Attribute name="text" value="UI_upgradePanelMessageCooldownMin_msg" localise="true" parameters="elvesPerBlastTextData">
						<AttributeSet name="elvesPerBlastTextData">
							<Attribute name="0" formula="System::evaluate('Selector::CanonHoursToFirePerLevel')" />
							<Attribute name="1" formula="System::evaluate('Selector::CanonMinutesToFirePerLevel')" />
						</AttributeSet>
					</Attribute>
					<Attribute name="font" value="eFont_Large" />
					<Attribute name="color" value="FFFFFFFF" />
				</AttributeSet>
				<AttributeSet name="button_OK">
					<Attribute name="button_text">
						<AttributeSet name="text">
							<Attribute name="text" value="UI_OK" localise="true" />
						</AttributeSet>
					</Attribute>
				</AttributeSet>
				<AttributeSet name="bg">
					<Attribute name="image" value="ICO_SuperSecretItem" />
				</AttributeSet>
				<AttributeSet name="left">
					<Attribute name="image" value="ICO_XMAS2014_CooldownReduced_LG" />
				</AttributeSet>
			</Attribute>
		</Action>
		<Action type="setVariable" intVariable="ElfCannonLevel" intValue="ElfCannonLevel+1" />
		<Action type="runScript" package="XMAS2014_UpgradeScripts" script="ConsumeToppedUpGunPowder" />
	</OnElfCannonUpgradedForCooldownMin>
	<OnElfCannonUpgradedToTen>
		<Action type="runScript" package="XMAS2014_UpgradeScripts" script="UpgradeSoundAndAnim" />
		<Action type="genericMessage">
			<Attribute name="config">
				<AttributeSet name="title">
					<Attribute name="text" value="UI_upgradePanelCastleLvL_title" localise="true" parameters="levelTextData">
						<AttributeSet name="levelTextData">
							<Attribute name="0" formula="Object::ElfCannonLevel+1" />
						</AttributeSet>
					</Attribute>
					<Attribute name="font" value="eFont_LargeBold" />
					<Attribute name="color" value="FFD51AFF" />
				</AttributeSet>
				<AttributeSet name="message">
					<Attribute name="text" value="UI_upgradePanelMessageCooldown10_msg" localise="true" parameters="elvesPerBlastTextData">
						<AttributeSet name="elvesPerBlastTextData">
							<Attribute name="0" formula="System::evaluate('Selector::CanonHoursToFirePerLevel')" />
							<Attribute name="1" formula="System::evaluate('Selector::CanonMinutesToFirePerLevel')" />
						</AttributeSet>
					</Attribute>
					<Attribute name="font" value="eFont_Large" />
					<Attribute name="color" value="FFFFFFFF" />
				</AttributeSet>
				<AttributeSet name="button_OK">
					<Attribute name="button_text">
						<AttributeSet name="text">
							<Attribute name="text" value="UI_OK" localise="true" />
						</AttributeSet>
					</Attribute>
				</AttributeSet>
				<AttributeSet name="bg">
					<Attribute name="image" value="ICO_SuperSecretItem" />
				</AttributeSet>
				<AttributeSet name="left">
					<Attribute name="image" value="ICO_XMAS2014_CooldownReduced_LG" />
				</AttributeSet>
			</Attribute>
		</Action>
		<Action type="setVariable" intVariable="ElfCannonLevel" intValue="ElfCannonLevel+1" />
		<Action type="runScript" package="XMAS2014_UpgradeScripts" script="ConsumeToppedUpGunPowder" />
	</OnElfCannonUpgradedToTen>
	<OnElfCannonUpgradedToTwenty>
		<Action type="runScript" package="XMAS2014_UpgradeScripts" script="UpgradeSoundAndAnim" />
		<Action type="genericMessage">
			<Attribute name="config">
				<AttributeSet name="title">
					<Attribute name="text" value="UI_upgradePanelCastleLvL_title" localise="true" parameters="levelTextData">
						<AttributeSet name="levelTextData">
							<Attribute name="0" formula="Object::ElfCannonLevel+1" />
						</AttributeSet>
					</Attribute>
					<Attribute name="font" value="eFont_LargeBold" />
					<Attribute name="color" value="FFD51AFF" />
				</AttributeSet>
				<AttributeSet name="message">
					<Attribute name="text" value="UI_upgradePanelMessageElfBerries20_msg" localise="true" parameters="elvesPerBlastTextData">
						<AttributeSet name="elvesPerBlastTextData">
							<Attribute name="0" formula="System::evaluate('Selector::CanonBerriesPerLevel')" />
						</AttributeSet>
					</Attribute>
					<Attribute name="font" value="eFont_Large" />
					<Attribute name="color" value="FFFFFFFF" />
				</AttributeSet>
				<AttributeSet name="button_OK">
					<Attribute name="button_text">
						<AttributeSet name="text">
							<Attribute name="text" value="UI_OK" localise="true" />
						</AttributeSet>
					</Attribute>
				</AttributeSet>
				<AttributeSet name="bg">
					<Attribute name="image" value="ICO_SuperSecretItem" />
				</AttributeSet>
				<AttributeSet name="left">
					<Attribute name="image" value="ICO_XMAS2014_ElfBottleMax_LG" />
				</AttributeSet>
			</Attribute>
		</Action>
		<Action type="setVariable" intVariable="ElfCannonLevel" intValue="ElfCannonLevel+1" />
		<Action type="runScript" package="XMAS2014_UpgradeScripts" script="ConsumeToppedUpGunPowder" />
	</OnElfCannonUpgradedToTwenty>
	<OnElfCannonUpgradedAfterTwenty>
		<Action type="runScript" package="XMAS2014_UpgradeScripts" script="UpgradeSoundAndAnim" />
		<Action type="genericMessage">
			<Attribute name="config">
				<AttributeSet name="title">
					<Attribute name="text" value="UI_upgradePanelCastleLvL_title" localise="true" parameters="levelTextData">
						<AttributeSet name="levelTextData">
							<Attribute name="0" formula="Object::ElfCannonLevel+1" />
						</AttributeSet>
					</Attribute>
					<Attribute name="font" value="eFont_LargeBold" />
					<Attribute name="color" value="FFD51AFF" />
				</AttributeSet>
				<AttributeSet name="message">
					<Attribute name="text" value="UI_BraggingRights" localise="true" />
					<Attribute name="font" value="eFont_Large" />
					<Attribute name="color" value="FFFFFFFF" />
				</AttributeSet>
				<AttributeSet name="button_OK">
					<Attribute name="button_text">
						<AttributeSet name="text">
							<Attribute name="text" value="UI_OK" localise="true" />
						</AttributeSet>
					</Attribute>
				</AttributeSet>
				<AttributeSet name="bg">
					<Attribute name="image" value="ICO_SuperSecretItem" />
				</AttributeSet>
				<AttributeSet name="left">
					<Attribute name="image" value="ICO_XMAS2014_BraggingRights_LG" />
				</AttributeSet>
			</Attribute>
		</Action>
		<Action type="setVariable" intVariable="ElfCannonLevel" intValue="ElfCannonLevel+1" />
		<Action type="runScript" package="XMAS2014_UpgradeScripts" script="ConsumeToppedUpGunPowder" />
	</OnElfCannonUpgradedAfterTwenty>
	<ConsumeToppedUpGunPowder>
		<Action type="checkRequirements">
			<Requirements>
				<Requirement type="land" land="Springfield" />
				<Requirement type="friend land" not="true" />
				<Requirement type="formula" formula="GunPowderBalance==System::evaluate('Spendable::GunPowder')" />
			</Requirements>
			<True>
				<Action type="loseResources" GunPowder="GunPowderBalance" />
				<Action type="gotoState" state="GameState_InGame" />
			</True>
			<False>
				<Action type="setVariable" intVariable="GunPowderBalance" intValue="System::evaluate('Spendable::GunPowder')" />
			</False>
		</Action>
	</ConsumeToppedUpGunPowder>
</ScriptPackage>