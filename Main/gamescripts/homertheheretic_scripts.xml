<ScriptPackage>
	<PrizeTrackOverReload>
		<Action type="message" text="{PrizeTrackOverReload}" formatMe="true" />
		<Action type="gotoFrontend" />
	</PrizeTrackOverReload>
	<OpenMasterQuest>
		<Action type="checkRequirements">
			<Requirement type="land" land="Springfield" />
			<True>
				<Action type="gotoState" state="GameState_QuestProgress">
					<Extras>
						<Attribute name="questParentDelegate" value="HomerTheHeretic_Master2" />
					</Extras>
				</Action>
			</True>
			<False>
				<Action type="pantoobject" building="KrustylandShuttleToSpringfield" fakeTouch="true" />
			</False>
		</Action>
	</OpenMasterQuest>
	<RecommendHomerTheHeretic ignoreHUD="true">
		<Action type="recommendation" recType="Event" eventName="UI_HomerTheHeretic_name" name="HomerTheHeretic_OnePanel" />
	</RecommendHomerTheHeretic>
	<EnterHomerTheHereticCategory>
		<Action type="focusOnMenuItem" menuCategory="HomerTheHeretic" />
	</EnterHomerTheHereticCategory>
	<HomerTheHeretic_OpenResourceMenu ignoreHUD="true">
		<Action type="checkRequirements">
			<Requirements>
				<Requirement type="land" land="Springfield" />
			</Requirements>
			<True>
				<Action type="if">
					<If>
						<Requirement type="active quest" quest="HomerTheHeretic_1" />
						<Then>
							<Action type="gotoState" state="GameState_SpecialEventJobList" backButtonRestoresPreviousState="true">
								<Extras>
									<Attribute name="SpecialEvent" value="HomerTheHeretic_Main" />
									<Attribute name="JobList" value="HomerTheHeretic_JL_01" />
								</Extras>
							</Action>
						</Then>
					</If>
					<ElseIf>
						<Requirement type="active quest" quest="HomerTheHeretic_2" />
						<Then>
							<Action type="gotoState" state="GameState_SpecialEventJobList" backButtonRestoresPreviousState="true">
								<Extras>
									<Attribute name="SpecialEvent" value="HomerTheHeretic_Main" />
									<Attribute name="JobList" value="HomerTheHeretic_JL_02" />
								</Extras>
							</Action>
						</Then>
					</ElseIf>
					<ElseIf>
						<Requirement type="active quest" quest="HomerTheHeretic_3" />
						<Then>
							<Action type="gotoState" state="GameState_SpecialEventJobList" backButtonRestoresPreviousState="true">
								<Extras>
									<Attribute name="SpecialEvent" value="HomerTheHeretic_Main" />
									<Attribute name="JobList" value="HomerTheHeretic_JL_03" />
								</Extras>
							</Action>
						</Then>
					</ElseIf>
					<ElseIf>
						<Requirement type="active quest" quest="HomerTheHeretic_4" />
						<Then>
							<Action type="gotoState" state="GameState_SpecialEventJobList" backButtonRestoresPreviousState="true">
								<Extras>
									<Attribute name="SpecialEvent" value="HomerTheHeretic_Main" />
									<Attribute name="JobList" value="HomerTheHeretic_JL_04" />
								</Extras>
							</Action>
						</Then>
					</ElseIf>
					<ElseIf>
						<Requirement type="active quest" quest="HomerTheHeretic_5" />
						<Then>
							<Action type="gotoState" state="GameState_SpecialEventJobList" backButtonRestoresPreviousState="true">
								<Extras>
									<Attribute name="SpecialEvent" value="HomerTheHeretic_Main" />
									<Attribute name="JobList" value="HomerTheHeretic_JL_05" />
								</Extras>
							</Action>
						</Then>
					</ElseIf>
				</Action>
			</True>
			<False>
				<Action type="gotoState" state="GameState_InGame" />
				<Action type="pantoobject" building="KrustylandShuttleToSpringfield" fakeTouch="true" />
			</False>
		</Action>
	</HomerTheHeretic_OpenResourceMenu>
	<ShowMiniEventPanel>
		<Action type="miniEventPanel">
			<Attribute name="config">
				<AttributeSet name="source">
					<Attribute name="file" value="HomerTheHereticMiniEventPopUp" />
				</AttributeSet>
				<AttributeSet name="playButtonText">
					<Requirement type="variable" variable="HomerTheHeretic_PanelSeen" not="true" />
					<Attribute name="text" value="UI_MiniEvents_PlayButton" localise="true" />
				</AttributeSet>
				<AttributeSet name="playButtonTextHL">
					<Requirement type="variable" variable="HomerTheHeretic_PanelSeen" not="true" />
					<Attribute name="text" value="UI_MiniEvents_PlayButton" localise="true" />
				</AttributeSet>
				<AttributeSet name="playButtonText">
					<Requirement type="variable" variable="HomerTheHeretic_PanelSeen" />
					<Attribute name="text" value="UI_OK" localise="true" />
				</AttributeSet>
				<AttributeSet name="playButtonTextHL">
					<Requirement type="variable" variable="HomerTheHeretic_PanelSeen" />
					<Attribute name="text" value="UI_OK" localise="true" />
				</AttributeSet>
				<AttributeSet name="titleText">
					<Attribute name="text" value="UI_HomerTheHeretic_IntroPanel_Title" localise="true" />
					<Attribute name="color" value="ffcb1bff" />
				</AttributeSet>
				<AttributeSet name="textColumn1">
					<Attribute name="text" value="UI_HomerTheHeretic_IntroPanel_Text1" localise="true" />
					<Attribute name="color" value="000000FF" />
				</AttributeSet>
				<AttributeSet name="textColumn2">
					<Attribute name="text" value="UI_HomerTheHeretic_IntroPanel_Text2" localise="true" />
					<Attribute name="color" value="000000FF" />
				</AttributeSet>
				<AttributeSet name="textColumn3">
					<Attribute name="text" value="UI_HomerTheHeretic_IntroPanel_Text3" localise="true" />
					<Attribute name="color" value="000000FF" />
				</AttributeSet>
				<AttributeSet name="panel">
					<Attribute name="image" value="BSE_HomerTheHeretic_MiniEventPanel_Intro" />
				</AttributeSet>
				<AttributeSet name="playButton">
					<Attribute name="color" value="0091F1FF" />
				</AttributeSet>
			</Attribute>
		</Action>
		<Action type="checkRequirements">
			<Requirement type="variable" variable="HomerTheHeretic_PanelSeen" not="true" />
			<True>
				<Action type="updateVariable" variable="HomerTheHeretic_Store" value="true" />
				<Action type="updateVariable" variable="HomerTheHeretic_PanelSeen" value="true" />
			</True>
		</Action>
	</ShowMiniEventPanel>
	<ShowMiniEventOutro>
		<Action type="miniEventPanel">
			<Attribute name="config">
				<AttributeSet name="source">
					<Attribute name="file" value="HomerTheHereticMiniEventPopUp" />
				</AttributeSet>
				<AttributeSet name="playButtonText">
					<Attribute name="text" value="UI_OK" localise="true" />
				</AttributeSet>
				<AttributeSet name="playButtonTextHL">
					<Attribute name="text" value="UI_OK" localise="true" />
				</AttributeSet>
				<AttributeSet name="titleText">
					<Attribute name="text" value="UI_HomerTheHeretic_OutroPanel_Title" localise="true" />
					<Attribute name="color" value="ffcb1bff" />
				</AttributeSet>
				<AttributeSet name="textColumn4">
					<Attribute name="text" value="UI_HomerTheHeretic_OutroPanel_Text1" localise="true" />
					<Attribute name="color" value="000000FF" />
				</AttributeSet>
				<AttributeSet name="textColumn5">
					<Attribute name="text" value="UI_HomerTheHeretic_OutroPanel_Text2" localise="true" />
					<Attribute name="color" value="000000FF" />
				</AttributeSet>
				<AttributeSet name="panel">
					<Attribute name="image" value="BSE_HomerTheHeretic_MiniEventPanel_Outro" />
				</AttributeSet>
				<AttributeSet name="playButton">
					<Attribute name="color" value="0091F1FF" />
				</AttributeSet>
			</Attribute>
		</Action>
	</ShowMiniEventOutro>
	<CheckIfEnd parallel="true">
		<Action type="checkRequirements">
			<Requirement type="variable" variable="HomerTheHeretic_EventExpired" />
			<True>
				<Action type="setVariable" boolVariable="HomerTheHeretic_Expired" boolValue="true" />
			</True>
		</Action>
	</CheckIfEnd>
	<RegisterTelemetry_Regular parallel="true">
		<Action type="updateVariable" variable="HTH_RegularKarma" value="HTH_RegularKarma + ConfigValue('__HomerTheHeretic_GameConfig:CurrencyRewards:RegularJobReward__')" />
		<Action type="updateVariable" variable="HTH_TotalKarma" value="HTH_TotalKarma + ConfigValue('__HomerTheHeretic_GameConfig:CurrencyRewards:RegularJobReward__')" />
	</RegisterTelemetry_Regular>
	<RegisterTelemetry_Premium parallel="true">
		<Action type="updateVariable" variable="HTH_PremiumKarma" value="HTH_PremiumKarma + ConfigValue('__HomerTheHeretic_GameConfig:CurrencyRewards:PremiumJobReward__')" />
		<Action type="updateVariable" variable="HTH_TotalKarma" value="HTH_TotalKarma + ConfigValue('__HomerTheHeretic_GameConfig:CurrencyRewards:PremiumJobReward__')" />
	</RegisterTelemetry_Premium>
	<LogTelemetry parallel="true">
		<Action type="logevent" formatMe="true" param1Type="Enumeration" param1="{task}" param2Type="Enumeration" param2="Regular_{RegularKarma}" param3Type="UserLevel" eventId="5201" />
		<Action type="logevent" formatMe="true" param1Type="Enumeration" param1="{task}" param2Type="Enumeration" param2="Premium_{PremiumKarma}" param3Type="UserLevel" eventId="5201" />
		<Action type="logevent" formatMe="true" param1Type="Enumeration" param1="{task}" param2Type="Enumeration" param2="Total_{TotalKarma}" param3Type="UserLevel" eventId="5201" />
	</LogTelemetry>
	<CollectingLuckyPennies_Done parallel="true">
		<Action type="updateVariable" variable="HTH_Telemetry_TimeSinceLastPennyFountainCollection" value="serverTime(0)-HTH_Telemetry_LastPennyFountainCollection" />
		<Action type="updateVariable" variable="HTH_Telemetry_LastPennyFountainCollection" value="serverTime(0)" />
	</CollectingLuckyPennies_Done>
	<PrizeTrackOverReload>
		<Action type="message" text="{PrizeTrackOverReload}" formatMe="true" />
		<Action type="gotoFrontend" />
	</PrizeTrackOverReload>
	<HomerTheHeretic_PrizeTrackEnded>
		<Action type="completeJob" name="CollectingLuckyPennies" giveRewardsRefunds="true" forceRefundOrCancel="true" />
		<Action type="collectIndicator" building="PennyFountain" withCallback="true" />
	</HomerTheHeretic_PrizeTrackEnded>
	<PutOutSimpsonFire parallel="true">
		<Action type="updateVariable" variable="HTH_SimpsonHomeFire" value="false" />
	</PutOutSimpsonFire>
	<PerfectBeerTruck_Tapped parallel="true" ignoreHUD="true">
		<Action type="anim-play" animation="ActiveNoLoop" />
	</PerfectBeerTruck_Tapped>
	<BrotherFaithVan_Tapped parallel="true" ignoreHUD="true">
		<Action type="anim-play" animation="ActiveNoLoop" />
	</BrotherFaithVan_Tapped>
	<FakeTollBooth_Tapped parallel="true" ignoreHUD="true">
		<Action type="anim-play" animation="ActiveNoLoop" />
	</FakeTollBooth_Tapped>
	<PanToFirstChurch>
		<Action type="checkRequirements">
			<Requirement type="building" building="FirstChurchofSpringfield" />
			<True>
				<Action type="pantoobject" building="FirstChurchofSpringfield" />
			</True>
		</Action>
	</PanToFirstChurch>
</ScriptPackage>